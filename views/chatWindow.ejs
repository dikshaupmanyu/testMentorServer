<%- include partials/innerheader %>

   
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/emoji.css">
    <script src="https://www.gstatic.com/firebasejs/ui/4.6.1/firebase-ui-auth.js"></script>
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.6.1/firebase-ui-auth.css" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">


    <link href="https://www.jqueryscript.net/css/jquerysctipttop.css" rel="stylesheet" type="text/css">
    <link src="../public/css/chatWindow.css" rel="stylesheet">

    <script>
        window.addEventListener("load", function() {

           // alert("<%= fcmToken %>");

             var fcmToken = "<%= fcmToken %>";
             // alert(fcmToken);

            var userName =  "<%= userName %>";
            // alert(userName);
            
            var LoggedInId = "<%= userid %>";
            // alert(LoggedInId);
            var replyIdss = "<%= uniquereply %>";

// alert(replyIdss);
            
            
            $('#msgreplyId').val(replyIdss);
            $("#user_nickname").val(userName);
            $('#user_id').val(LoggedInId);
            $("#user_fcm_token").val(fcmToken);
            // var today = new Date();
            // // alert(today);
            // var str = today.toDateString().split(' ').slice(1).join(' ') + " at " + today.toLocaleTimeString() + " GMT+5:30";
            // // alert(str);
            // $('#dateval').val(str);


          firebase.auth().signInWithCustomToken(fcmToken)
            .then((userCredential) => {
              // Signed in
              // console.log(userCredential);
              var user = userCredential.user;
              // var ids = userCredential.uid;
              console.log(user.uid);
              // ...
            })
            .catch((error) => {
              console.log("error is" + error);
              var errorCode = error.code;
              var errorMessage = error.message;
              // ...
            });
    });
    </script>
      <style type="text/css">

      #loading{
        position:fixed;
        width:100%;
        height:100vh;
        background: #fff
        url('https://loading.io/spinner/progress-pie/lg.percent-circular-preloader-gif.gif')
        no-repeat center;
        z-index:99999;
      }
      .chat
      {
          list-style: none;
          margin: 0;
          padding: 0;
          
      }

      .chat li
      {
          margin-bottom: 40px;
          padding-bottom: 5px;

          /* border-bottom: 1px dotted #B3A9A9; */
          /*margin-top: 10px;
          width: 80%;*/
      }


      .chat li .chat-body p
      {
          margin: 0;
           color: #ffff; 
      }


      .chat-care
      {
        overflow: hidden auto;
          height: 350px;
          /*height: 100%;*/
      }
      .chat-care .chat-img
      {
          width: 50px;
          height: 50px;
      }
      .chat-care .img-circle
      {
          border-radius: 50%;
      }
      .chat-care .chat-img
      {
          display: inline-block;
      }
      .chat-care .chat-body
      {
          display: inline-block;
          max-width: 80%;
          background-color: #0f2668eb;
          border-radius: 12.5px;
          padding: 15px;
          padding-top: 7px;
          padding-bottom: 10px;
          /* padding-left: 10px; */
      }
      .chat-care .chat-body strong
      {
        color: #ffff;
      }

      .text-muted{
        color: #ffff !important;
      }

      .chat-care .admin
      {
          text-align: right ;
          float: right;
      }
      .chat-care .admin p
      {
          text-align: left ;
      }
      .chat-care .agent
      {
          text-align: left ;
          float: left;
      }
      .chat-care .left
      {
          float: left;
      }
      .chat-care .right
      {
          float: right;
      }

      .clearfix {
        clear: both;
      }

      h1, h2, h3, h4, h5, h6, p {
          color: #000;
      }


      ::-webkit-scrollbar-track
      {
          box-shadow: inset 0 0 6px rgba(0,0,0,0.3);
          -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);
          background-color: #F5F5F5;
      }

      ::-webkit-scrollbar
      {
          width: 12px;
          background-color: #F5F5F5;
      }

      ::-webkit-scrollbar-thumb
      {
          box-shadow: inset 0 0 6px rgba(0,0,0,.3);
          -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,.3);
          background-color: #555;
      }


      .dashboard_wrapper.mentordashboard1_wrapper.card{
        height: 600px;
        height: calc(100vh - 120px);
      }

      .emojis{
        margin: 0 !important;
        position: absolute !important;
        bottom: 38px;
        right: 40px;
      }
     body .emoji-button{
        margin-left: calc(100% - 85px);
      }
      @media screen and (min-width:1600px) {
        .dashboard_wrapper.mentordashboard1_wrapper.card{
          height: calc(100vh - 180px);
        }
      }
      .input-group>#btn-input.form-control:focus{
        z-index: 1;
      }
      .emojis{
        z-index: 1;
        display: none;
      }
      .emojis[style*='display: block;'] + .emoji-button{
        pointer-events: none !important;
        opacity: .9;
      }



/* change Chat Style */
.chat li{
  position: relative;
}
.chat li .chat-body{
  position: relative;
  margin-top: 22px;
  margin-bottom: 25px;
}
.header.clearfix small.text-muted {
    bottom: -40px;
    position: absolute;
    left: 3px;
    color: #777 !important;
    min-width: 150px;
}
.header.clearfix small.text-muted.left{
  right: 3px;
  left: auto;
}

.header.clearfix strong.primary-font {
    position: absolute;
    top: -23px;
    left: 3px;
    color: #666 !important;
    font-weight: 100;
    font-size: 14px;
    min-width: 110px;
}
.header.clearfix strong.primary-font.right{
  right: 3px;
  left: auto;
}
.chat-care .chat-img .img-circle {
    border-radius: 50%;
    position: absolute;
    bottom: 9px;
    left: .5rem;
    background: #eee;
    object-fit: cover;
}
.chat-care .chat-img.right .img-circle {
    left: auto;
    right: .5rem;
}

.card-header{
  padding: 0.20rem 1.25rem;
}


/* /////////////////////////////////////// */

#fountainG{
  position:relative;
  width:168px;
  height:20px;
  margin:auto;
}

.fountainG{
  position:absolute;
  top:180px;
  background-color:rgb(31,36,135);
  width:20px;
  height:20px;
  animation-name:bounce_fountainG;
    -o-animation-name:bounce_fountainG;
    -ms-animation-name:bounce_fountainG;
    -webkit-animation-name:bounce_fountainG;
    -moz-animation-name:bounce_fountainG;
  animation-duration:1.105s;
    -o-animation-duration:1.105s;
    -ms-animation-duration:1.105s;
    -webkit-animation-duration:1.105s;
    -moz-animation-duration:1.105s;
  animation-iteration-count:infinite;
    -o-animation-iteration-count:infinite;
    -ms-animation-iteration-count:infinite;
    -webkit-animation-iteration-count:infinite;
    -moz-animation-iteration-count:infinite;
  animation-direction:normal;
    -o-animation-direction:normal;
    -ms-animation-direction:normal;
    -webkit-animation-direction:normal;
    -moz-animation-direction:normal;
  transform:scale(.3);
    -o-transform:scale(.3);
    -ms-transform:scale(.3);
    -webkit-transform:scale(.3);
    -moz-transform:scale(.3);
  border-radius:13px;
    -o-border-radius:13px;
    -ms-border-radius:13px;
    -webkit-border-radius:13px;
    -moz-border-radius:13px;
}

#fountainG_1{
  left:0;
  animation-delay:0.446s;
    -o-animation-delay:0.446s;
    -ms-animation-delay:0.446s;
    -webkit-animation-delay:0.446s;
    -moz-animation-delay:0.446s;
}

#fountainG_2{
  left:21px;
  animation-delay:0.5525s;
    -o-animation-delay:0.5525s;
    -ms-animation-delay:0.5525s;
    -webkit-animation-delay:0.5525s;
    -moz-animation-delay:0.5525s;
}

#fountainG_3{
  left:42px;
  animation-delay:0.659s;
    -o-animation-delay:0.659s;
    -ms-animation-delay:0.659s;
    -webkit-animation-delay:0.659s;
    -moz-animation-delay:0.659s;
}

#fountainG_4{
  left:63px;
  animation-delay:0.7755s;
    -o-animation-delay:0.7755s;
    -ms-animation-delay:0.7755s;
    -webkit-animation-delay:0.7755s;
    -moz-animation-delay:0.7755s;
}

#fountainG_5{
  left:84px;
  animation-delay:0.882s;
    -o-animation-delay:0.882s;
    -ms-animation-delay:0.882s;
    -webkit-animation-delay:0.882s;
    -moz-animation-delay:0.882s;
}

#fountainG_6{
  left:105px;
  animation-delay:0.9985s;
    -o-animation-delay:0.9985s;
    -ms-animation-delay:0.9985s;
    -webkit-animation-delay:0.9985s;
    -moz-animation-delay:0.9985s;
}

#fountainG_7{
  left:126px;
  animation-delay:1.105s;
    -o-animation-delay:1.105s;
    -ms-animation-delay:1.105s;
    -webkit-animation-delay:1.105s;
    -moz-animation-delay:1.105s;
}

#fountainG_8{
  left:147px;
  animation-delay:1.2115s;
    -o-animation-delay:1.2115s;
    -ms-animation-delay:1.2115s;
    -webkit-animation-delay:1.2115s;
    -moz-animation-delay:1.2115s;
}



@keyframes bounce_fountainG{
  0%{
  transform:scale(1);
    background-color:rgb(39,41,150);
  }

  100%{
  transform:scale(.3);
    background-color:rgb(255,255,255);
  }
}

@-o-keyframes bounce_fountainG{
  0%{
  -o-transform:scale(1);
    background-color:rgb(39,41,150);
  }

  100%{
  -o-transform:scale(.3);
    background-color:rgb(255,255,255);
  }
}

@-ms-keyframes bounce_fountainG{
  0%{
  -ms-transform:scale(1);
    background-color:rgb(39,41,150);
  }

  100%{
  -ms-transform:scale(.3);
    background-color:rgb(255,255,255);
  }
}

@-webkit-keyframes bounce_fountainG{
  0%{
  -webkit-transform:scale(1);
    background-color:rgb(39,41,150);
  }

  100%{
  -webkit-transform:scale(.3);
    background-color:rgb(255,255,255);
  }
}

@-moz-keyframes bounce_fountainG{
  0%{
  -moz-transform:scale(1);
    background-color:rgb(39,41,150);
  }

  100%{
  -moz-transform:scale(.3);
    background-color:rgb(255,255,255);
  }
}

 
.content {
              position: absolute;
              font-size: 12px;
              width:140px;
/*              height: 110px;
*/              
              height: auto;
              text-align: center;
              display: none;
              background-color:#0f2668eb;
              color:white;
              box-sizing: border-box;
              z-index: 100;
              border-radius:3px;
              margin-left: 15px;
              top:15px;    
   }
  
  .content-2 {
              /* display: flex; */
              position: absolute;
              font-size: 12px;
              width:140px;
           /*   height: 70px;*/
              height: auto;
              text-align: center;
              display: none;
              background:#0f2668eb;
              color:white;
              box-sizing: border-box;
              z-index: 100;
              border-radius:3px;
              margin-left: 15px;
              top:15px;    
   }

   .overlay{
     display:grid;
     justify-items: end;
   }
      
   .overlay-1{
     display:flex;
   }

  .pop{
    padding-top: 0.6rem;
    padding-bottom: 0.6rem;
    border-bottom: 0.5px solid black;
    cursor:pointer;
  }
  .pop2{
    padding-top: 0.6rem;
    padding-bottom: 0.6rem;
    cursor:pointer;
  }
  .pop:hover{
    background-color:#77839647
  }
  .pop2:hover{
  background-color:#77839647
  }


  .chat-body:hover .chev_ron{
    /* color:black !important; */
    display:block;
  }

  .chevron{
    color:black;
    display:flex;
    flex-direction: row-reverse;
    justify-content: flex-start;
    cursor: pointer;
    /* display:none; */
  }

  .chev_ron{
    display:none;
  }

  /*  for user  */
  .Content {
              position: absolute;
              font-size: 12px;
              width:140px;
             /* height: 110px;*/
             height: auto;
              text-align: center;
              display: none;
              background-color:#0f2668eb;
              color:white;
              box-sizing: border-box;
              z-index: 100;
              border-radius:3px;
              margin-right: 15px;
              top:15px;    
   }
  
  .Content-2 {
              /* display: flex; */
              position: absolute;
              font-size: 12px;
              width:140px;
             /* height: 70px;*/
             height: auto;
              text-align: center;
              display: none;
              background:#0f2668eb;
              color:white;
              box-sizing: border-box;
              z-index: 100;
              border-radius:3px;
              margin-right: 15px;
              top:15px;    
   }

   .Overlay{
     display:grid;
     justify-items: start;
   }
      
   .Overlay-1{
     display:flex;
     flex-direction: row-reverse;
   }

  .Pop{
    padding-top: 0.6rem;
    padding-bottom: 0.6rem;
    border-bottom: 0.5px solid black;
    cursor:pointer;
  }
  .Pop2{
    padding-top: 0.6rem;
    padding-bottom: 0.6rem;
    cursor:pointer;
  }
  .Pop:hover{
    background-color:#77839647
  }
  .Pop2:hover{
  background-color:#77839647
  }


  .chat-body:hover .Chev_ron{
    /* color:black !important; */
    display:block;
  }

  .Chevron{
    color:white;
    display:flex;
    flex-direction:column;
    justify-content: flex-start;
    cursor: pointer;
    /* display:none; */
  }

  .Chev_ron{
    display:none;
  }

  .right.text-muted a{
    color:#0f2668eb;
  }
  .left.text-muted a{
    color:#0f2668eb;
  }
  
      </style>
<!--       <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
 -->
      <div class="app_main">
                  
       <%- include partials/innersidebar %>
<!-- 
       <style type="text/css">
         #chatbox-history {
  overflow: none;
  position: relative;
  width: 100%;
  height: 200px;
  border: 1px solid #ccc;
}
#messages {
  overflow: auto;
  position: absolute;
  bottom: 0;
  width: 100%;
  max-height: 200px;
}
#messages div {
  border: 1px solid #e2e4e3;
  margin: 5px;
  padding: 10px;
  background: #fafafa;
}
       </style> -->

       <div class="app_content">
          <div class="dsbrd_container">


          <div class="dashboard_wrapper mentordashboard1_wrapper card" style="background: #ffff;">
                <div class="card-header text-center" style="border: none!important;">
                    <span><b>Strategy Chat Room</b></span>
                </div>

<!--     <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div id="chatbox-history">
  <div id="messages">
    <div>asdjf ;asd</div>
    <div>ajsd fa ;skd f;s</div>
    <div>asdjf ;akjs d;lf a;lksd fj</div>
    <div>ajsd fkaj s;dlf a;ljsdl;fkja;lsd f; asd</div>
    <div>Wassup?</div>
  </div>
</div>
    <script type="text/javascript">
        $('#messages').scrollTop($('#messages')[0].scrollHeight);
    </script> -->
   
                  <div id="fountainG">
                    <div id="fountainG_1" class="fountainG"></div>
                    <div id="fountainG_2" class="fountainG"></div>
                    <div id="fountainG_3" class="fountainG"></div>
                    <div id="fountainG_4" class="fountainG"></div>
                    <div id="fountainG_5" class="fountainG"></div>
                    <div id="fountainG_6" class="fountainG"></div>
                    <div id="fountainG_7" class="fountainG"></div>
                    <div id="fountainG_8" class="fountainG"></div>
                  </div>
                <div class="card-body chat-care">
                
                    <ul class="chat" id="tasks">
                    </ul>
                </div>
                <div class="card-footer" style="padding: 0px;">
                   <form onsubmit="return handleCreate(event)">
                    
                      <div class="input-group">
                        <input type="hidden" id="msgreplyId">
                        <input type="hidden" id="user_id">
                        <input type="hidden" id="user_nickname">
                        <input type="hidden" id="user_fcm_token">
                       <!--  <input type="hidden" id="dateval"> -->
                        <span class="input-group-btn">
                             <input type="file" style="display: none;">
                             <!-- <span class="name">No file selected</span> -->
                                <i class="fa fa-paperclip attachment btn btn-primary" aria-hidden="true" style="height: 38px; display:table-cell"></i>
                          
                        </span>
                        <input id="btn-input" type="text" class="form-control input-lg" placeholder="Type your message here..."   autocomplete="off"/>
                        <span class="input-group-btn">
                            <button class="btn btn-primary" type="submit">
                                <i class="fa fa-paper-plane" aria-hidden="true"></i>
                            </button>
                        </span>
                     
                      </div>
                   </form>
                  <!-- <div class="container">
                    <div><a href="replyMsg?messageId=${taskId}" target="_blank" style="color: black;">  ${countReply} Reply </a> </div> 
                    <a onClick='copyClipboard(this.id)' id='${taskId}'><div style="cursor:pointer;">Copy</div></a>
                    <a onClick='flagData(this.id)' id='${taskId}'><div style="cursor:pointer;">Flag</div></a>
                  </div> -->
                </div>

                <!-- ///////////// -->
              <!--   <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                  <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLongTitle">Chat Reply</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">&times;</span>
                        </button>
                      </div>
                      
                      <div class="modal-footer">
                        <input id="btn-input" type="text" class="form-control input-lg" placeholder="Type your message here..." />
                        <span class="input-group-btn">
                            <button class="btn btn-primary" type="submit">
                                <i class="fa fa-paper-plane" aria-hidden="true"></i>
                            </button>
                        </span>
                      </div>
                    </div>
                  </div>
                </div> -->
                <!-- ////// -->
                
          </div>

        </div>

      </div>

  </div>

 </div>
 </div>


<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
 -->
 
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
<!--     <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
 -->

<script>
  

// $(".card-body").animate({ scrollTop: $(document).height() }, "fast");

// $(document).ready(function() {
//     $('.card-body').animate({
//         scrollTop: $('.card-body').get(0).scrollHeight
//     }, 1000);
// });
</script>

<script  src="https://www.gstatic.com/firebasejs/8.2.2/firebase-app.js"></script>

<script  src="https://www.gstatic.com/firebasejs/8.2.2/firebase-auth.js"></script>
<script  src="https://www.gstatic.com/firebasejs/8.2.2/firebase-firestore.js"></script>

<script  src="https://www.gstatic.com/firebasejs/8.2.2/firebase-database.js"></script>
<script  src="https://www.gstatic.com/firebasejs/7.14.3/firebase-analytics.js"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.2/firebase.js"></script>


    <script src="js/main12.js"></script>

      <script type="text/javascript" src="js/custom.js"></script>


<!--     <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
 -->
    <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js'></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

    

  <script src='js/inputEmoji.js'></script>
  <script>
    
    
    $("#tasksuserlisttotal").on("click", function () {
      $("body").addClass("open__sidebar");
    });
    $(".app_header").on("click", function () {
      $("body").removeClass("open__sidebar");
    });
 
    $(function () {
      $('#btn-input').emoji({place: 'after'});

      $('.emoji-button').on("click", function(e){
        if($('.emojis').is(":visible")){
          console.log('click')
        }
      })

      $('emojis').on("hide", function() {
          //alert('hide');
       })
       $('emojis').on("show", function() {
          //alert('show');
       })

    })
  </script>
<br>
<script>
      var preloader = document.getElementById("fountainG");

      window.addEventListener("load", function(){
        preloader.style.display ="none"
      })
    </script>


</body>
</html>

<!-- <div><a href="replyMsg?messageId=${taskId}" target="_blank" style="color: black;">  ${countReply} Reply </a> </div> 
              <a onClick='copyClipboard(this.id)' id='${taskId}'><div style="cursor:pointer;">Copy</div></a>
              <a onClick='flagData(this.id)' id='${taskId}'><div style="cursor:pointer;">Flag</div></a> -->