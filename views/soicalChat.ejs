<%- include partials/innerheader %>


   
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/emoji.css">
    <link rel="stylesheet" href="css/socialChat.css">
    <script src="https://www.gstatic.com/firebasejs/ui/4.6.1/firebase-ui-auth.js"></script>
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.6.1/firebase-ui-auth.css" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">


    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emojionearea/3.4.2/emojionearea.css" integrity="sha512-0Nyh7Nf4sn+T48aTb6VFkhJe0FzzcOlqqZMahy/rhZ8Ii5Q9ZXG/1CbunUuEbfgxqsQfWXjnErKZosDSHVKQhQ==" crossorigin="anonymous" referrerpolicy="no-referrer" /> -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emojionearea/3.4.2/emojionearea.min.css" integrity="sha512-vEia6TQGr3FqC6h55/NdU3QSM5XR6HSl5fW71QTKrgeER98LIMGwymBVM867C1XHIkYD9nMTfWK2A0xcodKHNA==" crossorigin="anonymous" referrerpolicy="no-referrer" /> -->

    <link href="https://www.jqueryscript.net/css/jquerysctipttop.css" rel="stylesheet" type="text/css">
    <link src="../public/css/chatWindow.css" rel="stylesheet">
 


    <script>
        window.addEventListener("load", function() {

           // alert("<%= fcmToken %>");

             var fcmToken = "<%= fcmToken %>";
             // alert(fcmToken);

            var userName =  "<%= userName %>";
            // alert(userName);
            
            var LoggedInId = "<%= userid %>";
            // alert(LoggedInId);
            var replyIdss = "<%= uniquereply %>";

// alert(replyIdss);
            
            
            $('#msgreplyId').val(replyIdss);
            $("#user_nickname").val(userName);
            $('#user_id').val(LoggedInId);
            $("#user_fcm_token").val(fcmToken);
            // var today = new Date();
            // // alert(today);
            // var str = today.toDateString().split(' ').slice(1).join(' ') + " at " + 
            // today.toLocaleTimeString() + " GMT+5:30";
            // // alert(str);
            // $('#dateval').val(str);


          firebase.auth().signInWithCustomToken(fcmToken)
            .then((userCredential) => {
              // Signed in
              // console.log(userCredential);
              var user = userCredential.user;
              // var ids = userCredential.uid;
              console.log(user.uid);
              // ...
            })
            .catch((error) => {
              console.log("error is" + error);
              var errorCode = error.code;
              var errorMessage = error.message;
              // ...
            });
    });
    </script>

<!--       <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
 -->
      <div class="app_main">
                  
       <%- include partials/innersidebar %>


       <div class="app_content">
          <div class="dsbrd_container">
            <input type="hidden" id="nickdatavalue">

<script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
      <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
          <div class="dashboard_wrapper mentordashboard1_wrapper card" style="background: #ffff;">
                <div class="card-header text-center" style="border-bottom:1px solid">
                    <span><b id="room-button-3">Soical Chat Room</b> </span>
                </div>
                <div class="room">
                  <span>
                    <a class="rooms" role="button" id="dropdownUser" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Rooms <svg   xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-three-dots-vertical" viewBox="0 0 16 16">
                    <path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
                    </svg></a> 

                    <div class="dropdown-menu" aria-labelledby="dropdownUser" id="roomslist">
                      <ul>
                        <li><a href="/chatWindow">
           
                          <span id="room-Button-1">Enter Strategy Room</span>
                          </a>
                        </li>
                        <li><a  id="notmodalscalling">
           
                          <span id="room-Button-2">Enter @basilnsage Room</span>
                          </a>
                          <div class="modal fade" id="exampleModalCenterpin" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered" role="document">
                              <div class="modal-content">
                                <div>
                                  <h5 class="header-flag" id="exampleModalLongTitle">Enter Room Code</h5>
                                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                  </button>
                                </div>
            
                                 <div class="pincode">
                                    <div class="reasonFlag">
                                      <form id="formoid" enctype="multipart/form-data" onsubmit="return false">
                                      <input type="password" id="pcode" class="pin" placeholder="Enter Code Here"/>
                                      <br>
                                     <button type="submit" class="Btn_P btn btn-primary" id="Btn_Pop">Submit</button>
                                     </form>
                                    </div>
                                </div>
                              
                              </div>
                            </div>
                          </div>
                        </li>
                        <li><a href="/soicalChat">
           
                          <span id="room-Button-3">Enter Soical Chat Room</span>
                          </a>
                        </li>
                      </ul>
                    </div>  

                  </span>
                </div>

                <div class="card-mid-head" style="height:10px">

                  <div class="heading">
                    <b>Most Social Media Mentions Right Now.</b>
                  </div>

                  <div class="panel-heading">
                    <a  data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample"> 
                      <svg onclick="DownChevron()" id="chevron-down" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                      </svg>
                    </a>
                    <a data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
                      <svg onclick="UpChevron()" id="chevron-up"   xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-up" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z"/>
                      </svg>
                    </a>
                  </div>

                </div>

                <div id="collapseExample" aria-expanded="false" class="collapse show in">
                  <div class="colla">
                   <!--  <a style="cursor:pointer;"> Refresh it <img  src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABmJLR0QA/wD/AP+gvaeTAAABmUlEQVRIie3Wz05TQRTH8Q9rt7RqKE1qxPAibkyMQlADJsSlbgzhFXwKY/yzIUgDKBsTX0XZQRqlUdZUoS5m6i2lem+nF1b8krOZOTPfe+bOOXO41AVpYgTfOuZxG7O4Gsdb2MUn7GCvrI+r4x066OZYB68wPS50AYd9m65hETdwJdrNOLbe93GHuJsKvY7juNGWEHmeGtiMa07wNAU8gRdYTli7EsG/cT8FPo5Whch/oHLR8J0If5Pn+CBaWaoLF+7If6Ku4CBamUfTu2wr/3JoyvKxWSJ4UZYZZ/TQ2WJQ1pHPxP2+Dk5M4vsQcFtWFlPUf4KDtpHn8HEM8CS+Ddmzjeqg826cnBkD2K97Q8BDf+F2nHxUEpiCl3Y1zyFBhdK0Kkv4WonwQoXprRD1dongQqrip5xqc16aE560EzxPWP9EeFJHaa3+6lkEd4V62yiwpiHkfldoIq6lgAntS+/YO0J7s4RbTrc+j/Eev2Rv8EIqtKcaXirW7B3htQIZMco/qAmV6I4Q5VQcb+ELPuMD9kfY81Lnrz8ZRo+Yt/Ln7AAAAABJRU5ErkJggg=="/>
                    </a> -->
                     <span class="marquee" >
                      <div class="row" id="Marquee">
                      </div>
                     
                    </span>
                  
                  </div>  
                </div>
                <div class="card-low-hearder">
                  <span><b  style="position:relative; left:10px; font-size:14px">Live Stocks Chat</b> </span>
                  <p class="social-post">Aggregated Social Posts</p>
                </div>


<!--     <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div id="chatbox-history">
  <div id="messages">
    <div>asdjf ;asd</div>
    <div>ajsd fa ;skd f;s</div>
    <div>asdjf ;akjs d;lf a;lksd fj</div>
    <div>ajsd fkaj s;dlf a;ljsdl;fkja;lsd f; asd</div>
    <div>Wassup?</div>
  </div>
</div>
    <script type="text/javascript">
        $('#messages').scrollTop($('#messages')[0].scrollHeight);
    </script> -->
   
                  <div id="fountainG">
                    <div id="fountainG_1" class="fountainG"></div>
                    <div id="fountainG_2" class="fountainG"></div>
                    <div id="fountainG_3" class="fountainG"></div>
                    <div id="fountainG_4" class="fountainG"></div>
                    <div id="fountainG_5" class="fountainG"></div>
                    <div id="fountainG_6" class="fountainG"></div>
                    <div id="fountainG_7" class="fountainG"></div>
                    <div id="fountainG_8" class="fountainG"></div>
                  </div>
                <div class="card-body chat-care">
                
                    <ul class="chat" id="tasks" style="display: none;">
                    </ul>
                     <ul class="chat" id="twitterdata">
                    </ul>
                     <ul class="chat" id="redditdata">
                    </ul>
                </div>
                <div class="card-footer" style="padding: 0px;">
                   <form onsubmit=" return handleCreate(event)">
                    
                      <div class="input-group">
                        <input type="hidden" id="msgreplyId">
                        <input type="hidden" id="user_id">
                        <input type="hidden" id="user_nickname">
                        <input type="hidden" id="user_fcm_token">
                       <!--  <input type="hidden" id="dateval"> -->
                        <span class="input-group-btn">
                             <input type="file" id="imageUploaddata" style="display: none;">
                             <!-- <span class="name">No file selected</span> -->
                                <i class="fa fa-paperclip attachment btn btn-primary" aria-hidden="true" style="height: 38px; display:table-cell"></i>
                          
                        </span>
                        <input id="btn-input" type="text" class="form-control input-lg" placeholder="Type your message here..."   autocomplete="off"/>
                        <span class="input-group-btn">
                            <button class="btn btn-primary" type="submit" id="Btn_1">
                                <i class="fa fa-paper-plane" aria-hidden="true"></i>
                            </button>
                        </span>
                     
                      </div>
                   </form>

                </div>
                
          </div>

        </div>

      </div>

  </div>

 </div>
 </div>


<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
 -->
 
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
<!--     <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
 -->



<script  src="https://www.gstatic.com/firebasejs/8.2.2/firebase-app.js"></script>

<script  src="https://www.gstatic.com/firebasejs/8.2.2/firebase-auth.js"></script>
<script  src="https://www.gstatic.com/firebasejs/8.2.2/firebase-firestore.js"></script>

<script  src="https://www.gstatic.com/firebasejs/8.2.2/firebase-database.js"></script>
<script  src="https://www.gstatic.com/firebasejs/7.14.3/firebase-analytics.js"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.2/firebase.js"></script>


    <script src="js/mainSoical.js"></script>

      <script type="text/javascript" src="js/custom.js"></script>


<!--     <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
 -->
    <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js'></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

    

  <script src='js/inputEmoji.js'></script>
  <script>
    
    
    $("#tasksuserlisttotal").on("click", function () {
      $("body").addClass("open__sidebar");
    });
    $(".app_header").on("click", function () {
      $("body").removeClass("open__sidebar");
    });
 
    $(function () {
      $('#btn-input').emoji({place: 'after'});

      $('.emoji-button').on("click", function(e){
        if($('.emojis').is(":visible")){
            // alert('click');
             e.preventDefault();

        }
      })

      $('emojis').on("hide", function() {
          //alert('hide');
       })
       $('emojis').on("show", function() {
          //alert('show');
       })

    })


//     window.addEventListener('DOMContentLoaded', () => {
//   const button = document.querySelector('#emoji-button');
//   const picker = new EmojiButton();
//   picker.on('emoji', emoji => {
//     document.querySelector('input').value += emoji;
//   });
//   button.addEventListener('click', () => {
//     alert("hiii");
//     picker.pickerVisible ? picker.hidePicker() : picker.showPicker(button);
//   });
// });

    
  </script>
<br>
<script>
      var preloader = document.getElementById("fountainG");

      window.addEventListener("load", function(){
        preloader.style.display ="none"
      })
    </script>


<script src="js/vanillaEmojipicker.js"></script>
<script>

 window.addEventListener("load", function() {

 
   var LoggedInUsername = "<%= userName %>";
   var LoggedInEmail = "<%= email %>";
   var LoggedInId = "<%= userid %>";
   var tokens = "<%= tokens %>";
   // alert(LoggedInId);

$(document).ready(function(){

     var notificationdata = "" ;

     var notificationreddit = "";


  $.ajax({
        type: 'POST',
        url: 'https://apistest.tradetipsapp.com/api/stockTwitterDetails/getAllStockTwitterDetails',
        headers: {
          Authorization: 'Bearer '+ tokens,
           },
         // data: {userName : LoggedInUsername},
      success: function(data) {
        // alert(JSON.stringify(data));
       var datakpp = JSON.stringify(data);
       var dataResult = JSON.parse(datakpp);

       // alert(dataResult);

        if(dataResult.length > 0){
           for(i = 0; i < dataResult.length; i ++){

        notificationdata += '<li id="'+ dataResult[i].id +'"><li class="agent clearfix" style="width: 100%;height: auto;background-color: #dedede;"><span class="chat-img left clearfix mx-2"><img  src="images/twitter.png" alt="Admin" class="img-circle" style="width: 40px;height: 40px;"></span><div class="chat-body clearfix agent" style="float:none;"><div class="overlay"><div class="overlay-1"><div class="content" id="popupAf5wza0caGtCwTmsSmxd" style="display: none;"><a role="button" data-toggle="modal" data-target="#exampleModalCenterAf5wza0caGtCwTmsSmxd"> <div class="Pop" onclick="replypopup(this.id)" id="'+ dataResult[i].id +'">Reply</div></a><a onclick="copyClipboard(this.id)" id="'+ dataResult[i].id +'"><div class="pop" style="cursor:pointer;">Copy</div></a><a data-toggle="modal" data-target="#exampleModalCenterFlagAf5wza0caGtCwTmsSmxd"><div class="pop2">Flag</div></a></div></div></div><div class="header clearfix"><small class="right text-muted" style="color: #000"><span class="glyphicon glyphicon-time"><div id="finalValnAf5wza0caGtCwTmsSmxd" style="display: none;"><a onclick="replypopup(this.id)" id="'+ dataResult[i].id +'" role="button" data-toggle="modal" data-target="#exampleModalCenterAf5wza0caGtCwTmsSmxd"> Replies : <span id="sizedatanAf5wza0caGtCwTmsSmxd">0</span></a> </div></span>Mar 08, 5:13 PM  </small><strong class="primary-font" style="color: #000">'+ dataResult[i].userName +'</strong></div><p class="message" style="color: #000 !important"><span id="textMessageAf5wza0caGtCwTmsSmxd">'+ dataResult[i].tweet +' <img class="chevron" onclick="togglePopup(this.id)" id="'+ dataResult[i].id +'" src="https://img.icons8.com/external-royyan-wijaya-detailed-outline-royyan-wijaya/24/000000/external-chevron-arrow-line-royyan-wijaya-detailed-outline-royyan-wijaya.png"></span></p><div><div class="Comment"><a> <img src="https://img.icons8.com/ios/24/3498DB/topic.png"> '+ dataResult[i].quoteCount +' Comments</a></div><div class="likeComment"> '+ dataResult[i].likeCount +' <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAABjklEQVRIie2TPyiEcRjHP8/rdSibhUKGOyWjV7cpm+WyXJhkul4lg8lGNjPlvYyUYjAYrLJQRylRHGVA6bBxg/M+hrvXn6u79473Nt/l1+/X83w/3349D9RY8psma+VqTNBYV0t4fGtE3svVmtWa9ztXo4quKZg3T9d7wGq5euMX5uteMFfo9eupGFBk/gKA6EUgAMtJxz/NhXmFewBxOfwzwHLScWADMAUWjbfcskAYeG1+uD39E8By0sOeucJCyo7MumYoSn76jvbmB3N+AL8pWvbMj+3IHIDiRguzPWA5aS3Rd4shiaNEeNcsJC1VCIBnDmBAtGxxXu24mgQ6q96DlB0Z8qspBO6Aoi9yVWPf74bITrUBilXVolWivuRlFEDhriYAw5VpAENZCxzQlzxvUyEOvNeRSwYOQOttIARsH0723AQK6N08CwkkAARd8t4DAzQ9N4wBrcBJyu7eDxyAulP5k6Xvzz/2oNTc+236F4RMfbZx44dn2QYhAzxW5s0dYkwczHRkKwrzL08fV6+BbLrzBEwAAAAASUVORK5CYII="> <img class="likeButton" src="https://img.icons8.com/material-sharp/24/3498DB/thumb-up.png"><div></div></div></div></div></li></li>'; 
  
       }    
          // window.location.reload();

          $("#twitterdata").append(notificationdata);
         }
         else{
           
        }

         

    
     
     }

   });

    $.ajax({
        type: 'POST',
        url: 'https://apistest.tradetipsapp.com/api/redditStockCalculation/getAllRedditStockList',
        headers: {
          Authorization: 'Bearer '+ tokens,
           },
         // data: {userName : LoggedInUsername},
      success: function(data) {
        // alert(JSON.stringify(data));
       var datakpp = JSON.stringify(data);
       var dataResult = JSON.parse(datakpp);

       // alert(dataResult);

        if(dataResult.length > 0){
           for(i = 0; i < dataResult.length; i ++){

        notificationreddit += '<li id="'+ dataResult[i].id +'"><li class="agent clearfix" style="width: 100%;height: auto;background-color: #dedede;"><span class="chat-img left clearfix mx-2"><img  src="images/userIcon.png" alt="Admin" class="img-circle" style="width: 40px;height: 40px;"></span><div class="chat-body clearfix agent" style="float:none;"><div class="overlay"><div class="overlay-1"><div class="content" id="popupAf5wza0caGtCwTmsSmxd" style="display: none;"><a role="button" data-toggle="modal" data-target="#exampleModalCenterAf5wza0caGtCwTmsSmxd"> <div class="Pop" onclick="replypopup(this.id)" id="'+ dataResult[i].id +'">Reply</div></a><a onclick="copyClipboard(this.id)" id="'+ dataResult[i].id +'"><div class="pop" style="cursor:pointer;">Copy</div></a><a data-toggle="modal" data-target="#exampleModalCenterFlagAf5wza0caGtCwTmsSmxd"><div class="pop2">Flag</div></a></div></div></div><div class="header clearfix"><small class="right text-muted" style="color: #000"><span class="glyphicon glyphicon-time"><div id="finalValnAf5wza0caGtCwTmsSmxd" style="display: none;"><a onclick="replypopup(this.id)" id="'+ dataResult[i].id +'" role="button" data-toggle="modal" data-target="#exampleModalCenterAf5wza0caGtCwTmsSmxd"> Replies : <span id="sizedatanAf5wza0caGtCwTmsSmxd">0</span></a> </div></span>'+ dataResult[i].publishedTime +'</small><strong class="primary-font" style="color: #000">'+ dataResult[i].authorName +'</strong></div><p class="message" style="color: #000 !important"><span id="textMessageAf5wza0caGtCwTmsSmxd">'+ dataResult[i].title +' <img class="chevron" onclick="togglePopup(this.id)" id="'+ dataResult[i].id +'" src="https://img.icons8.com/external-royyan-wijaya-detailed-outline-royyan-wijaya/24/000000/external-chevron-arrow-line-royyan-wijaya-detailed-outline-royyan-wijaya.png"></span></p><div><div class="Comment"><a> <img src="https://img.icons8.com/ios/24/3498DB/topic.png"> '+ dataResult[i].totalComments +' Comments</a></div></div></div></div></div></li></li>'; 
  
       }    
          // window.location.reload();

          $("#redditdata").append(notificationreddit);
         }
         else{
           
        }

         

    
     
     }

   });



  function getNumberWithOrdinal(n) {
  var s = ["th","st","nd","rd"],
      v = n % 100;
  return n + (s[(v - 20) % 10] || s[v] || s[0]);
}

   var notificationVals = "" ;

    $.ajax({
        type: 'POST',
        url: 'https://apistest.tradetipsapp.com/api/socialChatStockDetails/getAllSocialChatStockDetailsList',
        headers: {
          Authorization: 'Bearer '+ tokens,
           },
         data: {userName : LoggedInUsername},
      success: function(data) {

       var datak = JSON.stringify(data);
       var dataResult = JSON.parse(datak);

        if(dataResult.length > 0){
          var n =0;
           for(i = 0; i < dataResult.length; i ++){
            n++;
        notificationVals += '<div class="col" style="border-right: 1px solid grey;"><h6 style="width:auto; text-align:center; max-width:120px; padding:0px;">'+dataResult[i].stockSymbol+'&nbsp;&nbsp;&nbsp;<span>'+ getNumberWithOrdinal(n) + '</span></h6></div>'; 
  
       }    

          $("#Marquee").append(notificationVals);
         }
         

         

    
     
     }

   });


  
  });

});

$(document).keypress(function (e) {
  
  if (e.which == 13) {
   e.preventDefault();
   $('#Btn_1').click();
  //  alert('Click button was trigger');
  }
 });
</script>

<script>
  function DownChevron() {


      document.getElementById("chevron-down").style.visibility = "hidden";
      document.getElementById("chevron-up").style.visibility = "visible";

  }

  function UpChevron(){
    // document.getElementById("Marquee").style.visibility = "visible";
    document.getElementById("chevron-up").style.visibility = "hidden";
    document.getElementById("chevron-down").style.visibility = "visible";
  }




  </script>

<script>

  window.history.forward(); 
          function noBack() { 
              window.history.forward(); 
          } 
             window.addEventListener("load", function() {
  
  
  
  // document.getElementById("modalcalling").style.display = "block";
  
  
  var config = {
  apiKey: "AIzaSyA0o46jRmw6OghL2fcpdIcNWDeG1EQ5upQ",
  authDomain: "tradetips-9baa3.firebaseapp.com",
  databaseURL: "https://tradetips-9baa3.firebaseio.com",
  projectId: "tradetips-9baa3",
  type: "service_account",
  project_id: "tradetips-9baa3",
  storageBucket: "tradetips-9baa3.appspot.com",
  messagingSenderId: "592114858590",
  appId: "1:592114858590:web:2e2f77237953b570fb52cf",
  measurementId: "G-B3RPK4JXG3",
  private_key_id: "9efaa0e3e7bf1fac231c69b552514e210442b223",
  private_key: "-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDoxICupYmqJ8yY\nmWkKk8lWp3dKzdAfOkAuyb8yrD9WWYOSUsAMIBY+irMBy74uFeJry8hfHicsBWSW\nuzL04S2S6dlJfeuBFI7GmgNIUG3GDfBROKeUS/XUzY2qg0+dNvgYgFbzoBNc0sMH\nxf4Ezarp/3CDqroWQRD0hvn2zUjNOnWqMP4NcZZfhyNJJcrFyvEWcMs8gWR0r+fQ\nijbGVgqf1n9T+HpGBXkXi9X3tZHe3HW4P6n0gjLU1eU8kOr6V6LDDAngp6ESsuQJ\nAyN81Sz9Axi4hygyWl7Oq7zpitVQxjHwzdMuWMGb/GbnHsleJRYHErk85qaHAvp1\nuS416baJAgMBAAECggEACe+VZJ8ZVMOVJrBpvPNZBVNpsq49Y4/bfIPNHw8eNwPk\nK2NP4lSeTnYiNQHq8NGrVBmjSHgjiOwEArEj+DMCfIJx7YKsAlsLyyt412XjgbBH\noVfvQ1PIvxg1I2GujNHzXixgSc779Jrki1jmwnK7CHkIZv5rKhcF78IxOllB8cyn\nsDdEOkYPAvYeVpIG1j3JQD4Yeo5xyT/MEhzZKqvNeg+uKkDS9R3P5jz94gRTbAtv\n3sKuS6Hrx2tn+BmqhpG1YFlKGMeTpAN42Jf96HJZQQvzho1AmTJh1Ep3fCgMOYhW\n0IJa1JnfVlHlZrL2NmLJ7ac+7yCIBPCXGtkihaHmzwKBgQD4g3si7vB2PBFTXxX5\nTJ0LubY/zyMp0sja/Rp2JYVVHh2WNHa6/TKyxksCG2OlMHbHV99QTrBuIyVYPWbN\njGPeQQAwd+y31RhHyePG99gwxvY8rRSzrEoPev6/6LHM5MdPqNzyujY0w0kUp5UR\nUyANKnCVeOll4IEmApBNfT3UhwKBgQDvx5buPbqdGA4mPKmEq/TLUy4OXVCnd1e3\nOe95qQIcbChCCAkSVeJ3nSvE5d0eBGJNlhaWeTA3DP/963o4frkRmaQJK9BsXdnb\nVj5iG3QRRKCYpamH1kY1AHc/G7P7a4hBPJ+4yblpGBiC7EayG9uBhgDA2sdLOPWW\nF1pZ20TwbwKBgAjz66a5hu4rgdBIF6mQigPXH+qykqi6EERbY+2nsmL7n8M+hpx7\n7KymGiOsSu2zjkPmNYRWIWMGXx0LsT1sdliWbORSHbQNuD811b/gQ+iV8l8DOUCz\nz0M5gh31yxn/j/KducAA110VP/e/hc5G+VugEMhBv97MtLpi00IHZgfXAoGBAIBq\nmWfQwY/+4R0TYgp++aSnUMQ6r8ZwwRaNPbcfj9TfDBSJLyqVuqsrDtTt8qVv3aIF\n3uUJ1Iu3N6arJZL6M228pkCPKZnQDaxNnS133IqfAY+fMZNha8pZDIRM9vCRH7Eo\nobYau2UQlZgQqLAdAUt2FBM1WITt5YFT0nzLVTmbAoGBAO/p5zqkeQ3Yjt7qIs8g\nbQTByK/9TsDRdiK9RfsEKuq70BHLuyYoW6jt9yR4AlbQHEFjGek9mWw4k45aZB5P\n2vjISHPiQoAAGVE9eowmvcckYn+IFFkNIs9s3UBX1d2RBzOgy3XMYE897DWGmKc+\n7F3mTXJtUyyjUqERXKBTYxN0\n-----END PRIVATE KEY-----\n",
  client_email: "firebase-adminsdk-olv1b@tradetips-9baa3.iam.gserviceaccount.com",
  client_id: "112955508654296836542",
  auth_uri: "https://accounts.google.com/o/oauth2/auth",
  token_uri: "https://oauth2.googleapis.com/token",
  auth_provider_x509_cert_url: "https://www.googleapis.com/oauth2/v1/certs",
  client_x509_cert_url: "https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-zgd2j%40chatdemo-96e4f.iam.gserviceaccount.com",
  vapidKey: 'BN2e4vqb2-OY-QX6Z0531oQ1pSiiEUNQU2SEcSaEiMvJFcy8unSAW6gPrFJQeHz0VQyPu2JLqVuaFDnfeDmpy3o'
  
  };
  
  // firebase.initializeApp(config);
  
  
  
  
  var db = firebase.firestore();
  var loggedInName =  "<%= userName %>";
  // alert(loggedInName);
   
   var loggedInVal = "<%= userid %>";
   // alert(LoggedInId);
  var nummers = db.collection("/basilPrivateGroup/Test/groupMembersInfo/").where('userName', '==', loggedInName);
  nummers.get().then(function (querySnapshot) {
  if(querySnapshot){
  console.log("okkk")
  querySnapshot.forEach(function (doc) {
  console.log(doc.id, ' => ', doc.data());
  document.getElementById("notmodalscalling").href = "/chatWindowAdminUser";
  });
  }
  
  if(querySnapshot.empty){
  console.log("not available");
  document.getElementById("notmodalscalling").setAttribute("data-target", "#exampleModalCenterpin");
  document.getElementById("notmodalscalling").setAttribute("data-toggle", "modal");
  }
  
  });
  
  
  
  // getGroupDetail();
  
  function getGroupDetails() {
  
  var monthlies = db.collection("/basilPrivateGroup").doc("Test").get();
  monthlies.then((res) => {
  // console.log(res.data().groupCode);
  document.getElementById('room-Button-2').innerText = "Enter " + res.data().groupTitle + " Room";
  
  });
  
  
  }
  
  getGroupDetails();
  
  function getGroupDetailroomOne() {
  
  var monthlies = db.collection("/openGroups").doc("demoOpenGroup1").get();
  monthlies.then((res) => {
  // console.log(res.data().groupCode);
  document.getElementById('room-Button-1').innerText = "Enter " + res.data().groupTitle + " Room";
  
  });
  
  
  }
  
  getGroupDetailroomOne();
  
  
  
  // getGroupDetailroomOne();
  
  function getSoicalChatroomOne() {
  
  var monthlies = db.collection("/socialchat").doc("Test").get();
  monthlies.then((res) => {
  console.log(res.data().groupTitle);
  document.getElementById('room-Button-3').innerText = "Enter " + res.data().groupTitle ;
  
  });
  
  
  }
  
  getSoicalChatroomOne();
  
  
  $("#formoid").submit(function(event){
  // alert("hiii");
  event.preventDefault();
  
  var monthlies = db.collection("/basilPrivateGroup").doc("Test").get();
  monthlies.then((res) => {
  // console.log(res.data().groupCode);
  var enterCode    = document.getElementById('pcode');
  if(enterCode.value == res.data().groupCode){
   var loggedInName =  "<%= userName %>";
   var loggedInName =  "<%= userName %>";
   // alert(userName);
   
   var loggedInVal = "<%= userid %>";
   // alert(LoggedInId);
  
  const docRef = db.collection("/basilPrivateGroup/Test/groupMembersInfo/");
  
  let task = {
  userName: loggedInName,
  userId : loggedInVal,
  id : loggedInVal + "_"+  Date.now(),
  createdDate :  Date.now(),
  profileImageUrl : "https://apistest.tradetipsapp.com/api/appUser/getImageByAppUserId?appUserId="+loggedInVal,
  messageSource : "Web"
  // status: "incomplete"
  };
  
  return docRef
  .add(task)
  .then((ref) => {
  // alert(ref.id);
  task.id = ref.id;
  
  window.location.href="/chatWindowAdminUser";
  
  
  });
  
  }else{
  console.log("false");
  alert("You enter Wrong code !!");
  }
  
  });
  
  
  });
  
  // alert("<%= fcmToken %>");
  
    var fcmToken = "<%= fcmToken %>";
    // alert(fcmToken);
  
   var userName =  "<%= userName %>";
   // alert(userName);
   
   var LoggedInId = "<%= userid %>";
   // alert(LoggedInId);
   var replyIdss = "<%= uniquereply %>";
  
  // alert(replyIdss);
     document.getElementById("nickdatavalue").setAttribute('value',userName);
  
   // $("#nickdatavalue").val(userName);
   // var today = new Date();
   // // alert(today);
   // var str = today.toDateString().split(' ').slice(1).join(' ') + " at " + 
   // today.toLocaleTimeString() + " GMT+5:30";
   // // alert(str);
   // $('#dateval').val(str);
  
  
  firebase.auth().signInWithCustomToken(fcmToken)
   .then((userCredential) => {
     // Signed in
     // console.log(userCredential);
     var user = userCredential.user;
     // var ids = userCredential.uid;
     console.log(user.uid);
     // ...
   })
   .catch((error) => {
     console.log("error is" + error);
     var errorCode = error.code;
     var errorMessage = error.message;
     // ...
   });
  });
  </script>
</body>
</html>
